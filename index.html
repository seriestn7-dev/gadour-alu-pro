<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gadour Alu - Pro (v14.0 Clean)</title>
    
    <meta name="description" content="Logiciel Calcul Menuiserie Aluminium Tunisie.">
    <meta name="robots" content="index, follow">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="sub-banner"></div>

    <div id="login-screen">
        <div class="login-box">
            <h1 style="color:#004085;">Gadour Alu ğŸ—ï¸</h1>
            <p style="color:#888;">Application Pro</p>
            <div id="errorMsg" class="error-msg"></div>
            <button id="googleBtn" onclick="loginWithGoogle()" class="btn-google-pro">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="24">
                <span>Continuer avec Google</span>
            </button>
        </div>
    </div>

    <div id="welcomePopup" class="popup-overlay" style="display: none;">
        <div class="popup-box" dir="rtl">
            <span class="close-btn" onclick="closeWelcomePopup()" style="float:left;">Ã—</span>
            <h2 style="color: #004085;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙŠÙƒ ÙÙŠ Gadour Pro Alu ğŸ‘‹</h2>
            <p>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ù„Ù…Ù†ÙŠÙˆÙ…: Ø¯ÙˆÙÙŠØŒ ÙØµØ§Ù„Ø©ØŒ ÙˆÙØ§ØªÙˆØ±Ø§Øª.</p>
            <button onclick="closeWelcomePopup()" class="btn-popup-ok">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ù†Ø¨Ø¯Ø£</button>
        </div>
    </div>

    <div id="expiredPopup" class="popup-overlay" style="display: none;">
        <div class="popup-box" style="border-top: 5px solid #dc3545;" dir="rtl">
            <h2 style="color: #dc3545;">â›” Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ !</h2>
            <p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ù„ØªØ¬Ø¯ÙŠØ¯.</p>
            <h1>ğŸ“ 55 000 000</h1>
            <button onclick="window.location.href='https://wa.me/21655000000'" class="btn-popup-ok">ğŸ’¬ WhatsApp</button>
        </div>
    </div>

    <div id="app-screen">
        <div class="navbar no-print">
            <button class="nav-btn active" onclick="switchMode('calc')">ğŸ“ Calcul</button>
            <button class="nav-btn" onclick="switchMode('debit')">âœ‚ï¸ DÃ©bit</button>
            <button class="nav-btn" onclick="switchMode('facture')">ğŸ“„ Facture</button>
            <button class="nav-btn" onclick="switchMode('profile')">ğŸ‘¤ Profil</button>
            <button class="nav-btn" onclick="switchMode('prices')">âš™ï¸ Prix</button>
            <button id="darkModeBtn" class="nav-btn" onclick="toggleDarkMode()" style="background:#444;">ğŸŒ™ Nuit</button>
            <button class="nav-btn" onclick="logout()" style="background:#dc3545; float:right;">Sortir</button>
        </div>

        <div class="container">
            <h1 class="no-print">Gadour Alu</h1>

            <div id="calc-view" class="mode-section active">
                <div class="input-grid no-print">
                    <div style="grid-column: span 2;">
                        <label>Type:</label>
                        <select id="productType" onchange="toggleFixOption()">
                            <option value="coulissant">FenÃªtre Coulissante</option>
                            <option value="ouvrant1v">FenÃªtre Ouvrante 1V (40404)</option>
                            <option value="ouvrant1v_40100">FenÃªtre Ouvrante 1V (40100)</option>
                            <option value="ouvrant2v">FenÃªtre Ouvrante 2V (40404)</option>
                            <option value="ouvrant2v_40100">FenÃªtre Ouvrante 2V (40100)</option>
                            <option value="beb1v">Porte 1V (Type 40100)</option>
                            <option value="beb2v">Porte 2V (Type 40100)</option>
                            <option value="monobloc">Store Monobloc (Lame 39)</option>
                            <option value="store_apparent">Store Rideau (Apparent -3cm)</option>
                            <option value="store_encastre">Store Rideau (EncastrÃ© +5cm)</option>
                        </select>
                    </div>
                    <div><label>Largeur (L):</label><input type="number" id="largeur" value="120" step="0.1"></div>
                    <div><label>Hauteur (H):</label><input type="number" id="hauteur" value="120" step="0.1"></div>
                    <div>
                        <label>Couleur:</label>
                        <select id="couleur">
                            <option value="1">Blanc</option>
                            <option value="1.15">Gris/Noir (+15%)</option>
                            <option value="1.30">Faux Bois (+30%)</option>
                        </select>
                    </div>
                    <div><label>Qte:</label><input type="number" id="quantite" value="1"></div>
                    <div><button id="btnAdd" class="btn btn-add" onclick="addItemToDevis()">+ Ajouter</button></div>

                    <div id="fixOptionContainer" class="fix-option-box" style="display:none;">
                        <label class="checkbox-wrapper"><input type="checkbox" id="hasFix" onchange="toggleFixInput()"> Avec Fixe ?</label>
                        <div id="fixInputWrapper" class="fix-details" style="display:none;">
                            <div><label>Pos:</label><select id="fixPosition"><option value="bottom">Bas</option><option value="top">Haut</option></select></div>
                            <div><label>Taille:</label><input type="number" id="fixSize" value="40"></div>
                        </div>
                    </div>
                    <div class="marge-section">
                        <label>Marge (%):</label><input type="number" id="margePercent" value="0">
                    </div>
                </div>

                <div id="devis-section">
                    <h3>Panier</h3>
                    <div id="devis-items"><table><thead><tr><th>Qte</th><th>Type</th><th>Mesure</th><th>DÃ©tails</th><th>X</th></tr></thead><tbody></tbody></table></div>
                    <button class="btn btn-calculate" onclick="calculateTotalDevis()">Calculer CoÃ»t</button>
                    <button class="btn btn-clear" onclick="clearDevis()">Vider</button>
                    <button class="btn btn-save" onclick="saveCurrentDevis()">ğŸ’¾ Sauvegarder</button>
                </div>
                <div id="total-result"></div>
            </div>

            <div id="debit-view" class="mode-section">
                <h2>âœ‚ï¸ Plan de Coupe</h2>
                <button class="btn btn-debit no-print" onclick="calculateDebit()">GÃ©nÃ©rer</button>
                <div id="visual-drawings" class="drawing-container"></div>
                <div id="debit-result"></div>
            </div>
            <div id="facture-view" class="mode-section">
                <div class="invoice-box">
                    <div class="invoice-header"><div class="company-info"><input type="text" class="company-name" value="GADOUR ALU"></div><input type="date" id="factureDate"></div>
                    <table class="facture-table-pro" id="facture-table"><thead><tr><th>DÃ©signation</th><th>QtÃ©</th><th>P.U</th><th>Total</th></tr></thead><tbody></tbody></table>
                    <div class="total-section"><h2>Total: <span id="facture-total-display">0.000</span> TND</h2></div>
                </div>
                <button class="btn btn-print no-print" onclick="window.print()">Imprimer</button>
            </div>
            <div id="profile-view" class="mode-section">
                <h2>ğŸ‘¤ Mon Espace</h2>
                <div class="profile-card"><h3 id="displayUsername">...</h3><div id="subStatusBadge">...</div><p id="daysRemaining"></p></div>
                <div id="history-list"></div>
            </div>
            <div id="prices-view" class="mode-section">
                <h2>âš™ï¸ Prix</h2>
                <div class="price-input-container"><span>Vitrage mÂ² : </span><input type="number" class="price-input" data-price-key="v_ballar" value="45" onchange="updatePrice('v_ballar', this.value)"></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div id="table-prices-profiles"></div>
                    <div id="table-prices-accessoires"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
